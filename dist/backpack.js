!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Backpack=e():t.Backpack=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var a=n[r]={i:r,l:!1,exports:{}};return t[r].call(a.exports,a,a.exports,e),a.l=!0,a.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=2)}([function(t,e,n){t.exports=n(1).default},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(){function t(){r(this,t)}return a(t,[{key:"forceFallback",value:function(t){var e=this.extraData?this.extraData:{};return this.setState("default",!0),CD.setExtraData(e),t instanceof Error?(CD.log(t),CD.throwError(t)):(CD.log(new Error(t).stack),CD.cancelRequest(t))}},{key:"trigger",value:function(t,e){var n=new CustomEvent(t,{detail:e,bubbles:!0,cancelable:!0});document.dispatchEvent(n)}},{key:"on",value:function(t,e){document.addEventListener(t,function(t){e(t)})}},{key:"setState",value:function(t,e){this.extraData=this.extraData?this.extraData:{},this.extraData[t]=e}},{key:"getState",value:function(){return this.extraData}}]),t}();e.default=o},function(t,e,n){t.exports=n(0)}])});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovLy9iYWNrcGFjay5qcyIsIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAgNDgwZmU1MTZhYjFlYWM0YTAzMDQiLCJ3ZWJwYWNrOi8vLy4vaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vYmFja3BhY2suanMiXSwibmFtZXMiOlsicm9vdCIsImZhY3RvcnkiLCJleHBvcnRzIiwibW9kdWxlIiwiZGVmaW5lIiwiYW1kIiwidGhpcyIsIm1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJpbnN0YWxsZWRNb2R1bGVzIiwiaSIsImwiLCJjYWxsIiwibSIsImMiLCJ2YWx1ZSIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiY29uZmlndXJhYmxlIiwiZW51bWVyYWJsZSIsImdldCIsIm4iLCJfX2VzTW9kdWxlIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiZGVmYXVsdCIsIl9jbGFzc0NhbGxDaGVjayIsImluc3RhbmNlIiwiQ29uc3RydWN0b3IiLCJUeXBlRXJyb3IiLCJfY3JlYXRlQ2xhc3MiLCJkZWZpbmVQcm9wZXJ0aWVzIiwidGFyZ2V0IiwicHJvcHMiLCJsZW5ndGgiLCJkZXNjcmlwdG9yIiwid3JpdGFibGUiLCJrZXkiLCJwcm90b1Byb3BzIiwic3RhdGljUHJvcHMiLCJCYWNrcGFjayIsImUiLCJleHRyYURhdGEiLCJzZXRTdGF0ZSIsIkNEIiwic2V0RXh0cmFEYXRhIiwiRXJyb3IiLCJsb2ciLCJ0aHJvd0Vycm9yIiwic3RhY2siLCJjYW5jZWxSZXF1ZXN0IiwiZXZlbnRUeXBlIiwiZXZlbnRNc2ciLCJldmVudCIsIkN1c3RvbUV2ZW50IiwiZGV0YWlsIiwiYnViYmxlcyIsImNhbmNlbGFibGUiLCJkb2N1bWVudCIsImRp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LFVBQVNDLGNBQWNOLE1Ib0h2QmhCLElBQUssS0FDTDlCLE1BQU8sU0czR044QyxFQUFPTyxHQUVSRixTQUFTRyxpQkFBaUJSLEVBQU8sU0FBQ1osR0FDaENtQixFQUFTbkIsUUhzSFhKLElBQUssV0FDTDlCLE1BQU8sU0c3R0E4QixFQUFLOUIsR0FDWlYsS0FBSzZDLFVBQWE3QyxLQUFLNkMsVUFBYTdDLEtBQUs2QyxhQUN6QzdDLEtBQUs2QyxVQUFVTCxHQUFPOUIsS0hzSHRCOEIsSUFBSyxXQUNMOUIsTUFBTyxXRy9HUCxNQUFPVixNQUFLNkMsY0hvSFBGLElBR29CL0MsR0FBaUIsUUdyTXpCK0MsR0h5TWYsU0FBUzlDLEVBQVFELEVBQVNNLEdBRWhDTCxFQUFPRCxRQUFVTSxFQUFvQiIsImZpbGUiOiJiYWNrcGFjay5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7XG5cdGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0Jylcblx0XHRtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcblx0ZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpXG5cdFx0ZGVmaW5lKFtdLCBmYWN0b3J5KTtcblx0ZWxzZSBpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpXG5cdFx0ZXhwb3J0c1tcIkJhY2twYWNrXCJdID0gZmFjdG9yeSgpO1xuXHRlbHNlXG5cdFx0cm9vdFtcIkJhY2twYWNrXCJdID0gZmFjdG9yeSgpO1xufSkodGhpcywgZnVuY3Rpb24oKSB7XG5yZXR1cm4gXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHdlYnBhY2svdW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbiIsIihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7XG5cdGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0Jylcblx0XHRtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcblx0ZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpXG5cdFx0ZGVmaW5lKFtdLCBmYWN0b3J5KTtcblx0ZWxzZSBpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpXG5cdFx0ZXhwb3J0c1tcIkJhY2twYWNrXCJdID0gZmFjdG9yeSgpO1xuXHRlbHNlXG5cdFx0cm9vdFtcIkJhY2twYWNrXCJdID0gZmFjdG9yeSgpO1xufSkodGhpcywgZnVuY3Rpb24oKSB7XG5yZXR1cm4gLyoqKioqKi8gKGZ1bmN0aW9uKG1vZHVsZXMpIHsgLy8gd2VicGFja0Jvb3RzdHJhcFxuLyoqKioqKi8gXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuLyoqKioqKi8gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuLyoqKioqKi8gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKVxuLyoqKioqKi8gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4vKioqKioqLyBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuLyoqKioqKi8gXHRcdFx0aTogbW9kdWxlSWQsXG4vKioqKioqLyBcdFx0XHRsOiBmYWxzZSxcbi8qKioqKiovIFx0XHRcdGV4cG9ydHM6IHt9XG4vKioqKioqLyBcdFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4vKioqKioqLyBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbi8qKioqKiovIFx0XHRtb2R1bGUubCA9IHRydWU7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4vKioqKioqLyBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuLyoqKioqKi8gXHR9XG4vKioqKioqL1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBpZGVudGl0eSBmdW5jdGlvbiBmb3IgY2FsbGluZyBoYXJtb255IGltcG9ydHMgd2l0aCB0aGUgY29ycmVjdCBjb250ZXh0XG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uaSA9IGZ1bmN0aW9uKHZhbHVlKSB7IHJldHVybiB2YWx1ZTsgfTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbi8qKioqKiovIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4vKioqKioqLyBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuLyoqKioqKi8gXHRcdFx0XHRjb25maWd1cmFibGU6IGZhbHNlLFxuLyoqKioqKi8gXHRcdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuLyoqKioqKi8gXHRcdFx0XHRnZXQ6IGdldHRlclxuLyoqKioqKi8gXHRcdFx0fSk7XG4vKioqKioqLyBcdFx0fVxuLyoqKioqKi8gXHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4vKioqKioqLyBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4vKioqKioqLyBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuLyoqKioqKi8gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbi8qKioqKiovIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4vKioqKioqLyBcdFx0cmV0dXJuIGdldHRlcjtcbi8qKioqKiovIFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4vKioqKioqLyBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDIpO1xuLyoqKioqKi8gfSlcbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4vKioqKioqLyAoW1xuLyogMCAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cbi8vIGEgYml0IG9mIGEgaGFjayBidXQgZXhwb3J0aW5nIGxpa2UgdGhpcyBlbnN1cmVzIHdlIGRvbid0IGdldFxuLy8gdGhlIGxpYiBleHBvcnRlZCB3aXRoIGAuZGVmYXVsdGAgaW4gdGhlIGJyb3dzZXJcbm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKS5kZWZhdWx0O1xuXG4vKioqLyB9LFxuLyogMSAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxudmFyIEJhY2twYWNrID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBCYWNrcGFjaygpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQmFja3BhY2spO1xuICB9XG5cbiAgX2NyZWF0ZUNsYXNzKEJhY2twYWNrLCBbe1xuICAgIGtleTogJ2ZvcmNlRmFsbGJhY2snLFxuXG5cbiAgICAvKipcbiAgICAgKiBUcmlnZ2VycyB0aGUgZmFsbGJhY2sgaW1hZ2UgdG8gc2hvdy5cbiAgICAgKlxuICAgICAqIERldGVybWluZSB0aGUgdHlwZSBvZiBlcnJvciB3ZSBoYXZlIHBhc3NlZC5cbiAgICAgKiBXYXMgaXQgc29tZXRoaW5nIHdlIHdlcmUgbG9va2luZyBmb3I6XG4gICAgICogaS5lIG5vdCBlbm91Z2ggaXRlbXMgKGluIHdoaWNoIGNhc2UgaXQgaXMgYSBjYW5jZWxSZXF1ZXN0KVxuICAgICAqXG4gICAgICogT3Igd2FzIGl0IGFuIGVycm9yIHdlIGRpZG4ndCBjYXRjaDpcbiAgICAgKiBpLmUgQVBJIHJldHVybmVkIG5vbiBKU09OIGluZm9ybWF0aW9uIHdoZW4gd2Ugd2VyZSBleHBlY3RpbmcgSlNPTlxuICAgICAqIChpbiB3aGljaCBjYXNlIHdlIHRocm93IGFuIGVycm9yLCB3aGljaCBpbiB0dXJucyBub3RpZmllcyBEZXYpXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZVxuICAgICAqIEByZXR1cm5zIHsqfVxuICAgICAqL1xuICAgIHZhbHVlOiBmdW5jdGlvbiBmb3JjZUZhbGxiYWNrKGUpIHtcblxuICAgICAgdmFyIGV4dHJhRGF0YSA9IHRoaXMuZXh0cmFEYXRhID8gdGhpcy5leHRyYURhdGEgOiB7fTtcbiAgICAgIHRoaXMuc2V0U3RhdGUoJ2RlZmF1bHQnLCB0cnVlKTtcbiAgICAgIENELnNldEV4dHJhRGF0YShleHRyYURhdGEpO1xuXG4gICAgICBpZiAoZSBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAgIENELmxvZyhlKTtcbiAgICAgICAgcmV0dXJuIENELnRocm93RXJyb3IoZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBDRC5sb2cobmV3IEVycm9yKGUpLnN0YWNrKTtcbiAgICAgICAgcmV0dXJuIENELmNhbmNlbFJlcXVlc3QoZSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLyoqKipcbiAgICAgKiBDcmVhdGVzIGEgc3ludGhldGljIGV2ZW50XG4gICAgICogQHBhcmFtIGV2ZW50VHlwZVxuICAgICAqIEBwYXJhbSBldmVudE1zZ1xuICAgICAqIEByZXR1cm5zIHtFdmVudH1cbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiAndHJpZ2dlcicsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHRyaWdnZXIoZXZlbnRUeXBlLCBldmVudE1zZykge1xuXG4gICAgICB2YXIgZXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoZXZlbnRUeXBlLCB7XG4gICAgICAgIGRldGFpbDogZXZlbnRNc2csXG4gICAgICAgIGJ1YmJsZXM6IHRydWUsXG4gICAgICAgIGNhbmNlbGFibGU6IHRydWVcbiAgICAgIH0pO1xuXG4gICAgICBkb2N1bWVudC5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcbiAgICB9XG5cbiAgICAvKioqXG4gICAgICogQXR0YWNoZXMgYW4gZXZlbnRcbiAgICAgKiBAcGFyYW0gZXZlbnRcbiAgICAgKiBAcGFyYW0gY2FsbGJhY2tcbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiAnb24nLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBvbihldmVudCwgY2FsbGJhY2spIHtcblxuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgY2FsbGJhY2soZSk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvKioqXG4gICAgICogU2V0cyBhIHZhbHVlIHRvIGEga2V5IGZvciBleHRyYURhdGFcbiAgICAgKiBAcGFyYW0ga2V5XG4gICAgICogQHBhcmFtIHZhbHVlXG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogJ3NldFN0YXRlJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0U3RhdGUoa2V5LCB2YWx1ZSkge1xuICAgICAgdGhpcy5leHRyYURhdGEgPSB0aGlzLmV4dHJhRGF0YSA/IHRoaXMuZXh0cmFEYXRhIDoge307XG4gICAgICB0aGlzLmV4dHJhRGF0YVtrZXldID0gdmFsdWU7XG4gICAgfVxuXG4gICAgLyoqKlxuICAgICAqIFJldHVybnMgYWxsIGRhdGEgY3VycmVudGx5IGluIGV4dHJhRGF0YSBvYmplY3RcbiAgICAgKiBAcmV0dXJucyB7b2JqZWN0fVxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdnZXRTdGF0ZScsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGdldFN0YXRlKCkge1xuICAgICAgcmV0dXJuIHRoaXMuZXh0cmFEYXRhO1xuICAgIH1cbiAgfV0pO1xuXG4gIHJldHVybiBCYWNrcGFjaztcbn0oKTtcblxuLyogaGFybW9ueSBkZWZhdWx0IGV4cG9ydCAqLyBleHBvcnRzW1wiZGVmYXVsdFwiXSA9IEJhY2twYWNrO1xuXG4vKioqLyB9LFxuLyogMiAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cbm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcblxuXG4vKioqLyB9XG4vKioqKioqLyBdKTtcbn0pO1xuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBiYWNrcGFjay5qcyIsIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKVxuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuXG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBpZGVudGl0eSBmdW5jdGlvbiBmb3IgY2FsbGluZyBoYXJtb255IGltcG9ydHMgd2l0aCB0aGUgY29ycmVjdCBjb250ZXh0XG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmkgPSBmdW5jdGlvbih2YWx1ZSkgeyByZXR1cm4gdmFsdWU7IH07XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuIFx0XHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcbiBcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG4gXHRcdFx0XHRnZXQ6IGdldHRlclxuIFx0XHRcdH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDIpO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHdlYnBhY2svYm9vdHN0cmFwIDQ4MGZlNTE2YWIxZWFjNGEwMzA0IiwiLy8gYSBiaXQgb2YgYSBoYWNrIGJ1dCBleHBvcnRpbmcgbGlrZSB0aGlzIGVuc3VyZXMgd2UgZG9uJ3QgZ2V0XG4vLyB0aGUgbGliIGV4cG9ydGVkIHdpdGggYC5kZWZhdWx0YCBpbiB0aGUgYnJvd3NlclxubW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuL2JhY2twYWNrJykuZGVmYXVsdDtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL2luZGV4LmpzIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQmFja3BhY2sge1xuXG4gIC8qKlxuICAgKiBUcmlnZ2VycyB0aGUgZmFsbGJhY2sgaW1hZ2UgdG8gc2hvdy5cbiAgICpcbiAgICogRGV0ZXJtaW5lIHRoZSB0eXBlIG9mIGVycm9yIHdlIGhhdmUgcGFzc2VkLlxuICAgKiBXYXMgaXQgc29tZXRoaW5nIHdlIHdlcmUgbG9va2luZyBmb3I6XG4gICAqIGkuZSBub3QgZW5vdWdoIGl0ZW1zIChpbiB3aGljaCBjYXNlIGl0IGlzIGEgY2FuY2VsUmVxdWVzdClcbiAgICpcbiAgICogT3Igd2FzIGl0IGFuIGVycm9yIHdlIGRpZG4ndCBjYXRjaDpcbiAgICogaS5lIEFQSSByZXR1cm5lZCBub24gSlNPTiBpbmZvcm1hdGlvbiB3aGVuIHdlIHdlcmUgZXhwZWN0aW5nIEpTT05cbiAgICogKGluIHdoaWNoIGNhc2Ugd2UgdGhyb3cgYW4gZXJyb3IsIHdoaWNoIGluIHR1cm5zIG5vdGlmaWVzIERldilcbiAgICpcbiAgICogQHBhcmFtIGVcbiAgICogQHJldHVybnMgeyp9XG4gICAqL1xuICBmb3JjZUZhbGxiYWNrKGUpe1xuXG4gICAgY29uc3QgZXh0cmFEYXRhID0gdGhpcy5leHRyYURhdGEgPyB0aGlzLmV4dHJhRGF0YSA6IHt9O1xuICAgIHRoaXMuc2V0U3RhdGUoJ2RlZmF1bHQnLCB0cnVlKTtcbiAgICBDRC5zZXRFeHRyYURhdGEoZXh0cmFEYXRhKTtcblxuICAgIGlmKGUgaW5zdGFuY2VvZiBFcnJvcil7XG4gICAgICBDRC5sb2coZSk7XG4gICAgICByZXR1cm4gQ0QudGhyb3dFcnJvcihlKTtcbiAgICB9IGVsc2V7XG4gICAgICBDRC5sb2cobmV3IEVycm9yKGUpLnN0YWNrKTtcbiAgICAgIHJldHVybiBDRC5jYW5jZWxSZXF1ZXN0KGUpO1xuICAgIH1cbiAgfVxuXG4gIC8qKioqXG4gICAqIENyZWF0ZXMgYSBzeW50aGV0aWMgZXZlbnRcbiAgICogQHBhcmFtIGV2ZW50VHlwZVxuICAgKiBAcGFyYW0gZXZlbnRNc2dcbiAgICogQHJldHVybnMge0V2ZW50fVxuICAgKi9cbiAgdHJpZ2dlcihldmVudFR5cGUsIGV2ZW50TXNnKXtcblxuICAgIGNvbnN0IGV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KGV2ZW50VHlwZSwge1xuICAgICAgZGV0YWlsICAgICA6IGV2ZW50TXNnLFxuICAgICAgYnViYmxlcyAgICA6IHRydWUsXG4gICAgICBjYW5jZWxhYmxlIDogdHJ1ZVxuICAgIH0pO1xuXG4gICAgZG9jdW1lbnQuZGlzcGF0Y2hFdmVudChldmVudCk7XG5cbiAgfVxuXG5cbiAgLyoqKlxuICAgKiBBdHRhY2hlcyBhbiBldmVudFxuICAgKiBAcGFyYW0gZXZlbnRcbiAgICogQHBhcmFtIGNhbGxiYWNrXG4gICAqL1xuICBvbihldmVudCwgY2FsbGJhY2spe1xuXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgKGUpID0+e1xuICAgICAgY2FsbGJhY2soZSk7XG4gICAgfSk7XG5cbiAgfVxuXG4gIC8qKipcbiAgICogU2V0cyBhIHZhbHVlIHRvIGEga2V5IGZvciBleHRyYURhdGFcbiAgICogQHBhcmFtIGtleVxuICAgKiBAcGFyYW0gdmFsdWVcbiAgICovXG4gIHNldFN0YXRlKGtleSwgdmFsdWUpe1xuICAgIHRoaXMuZXh0cmFEYXRhID0gKHRoaXMuZXh0cmFEYXRhKSA/IHRoaXMuZXh0cmFEYXRhIDoge307XG4gICAgdGhpcy5leHRyYURhdGFba2V5XSA9IHZhbHVlO1xuICB9XG5cbiAgLyoqKlxuICAgKiBSZXR1cm5zIGFsbCBkYXRhIGN1cnJlbnRseSBpbiBleHRyYURhdGEgb2JqZWN0XG4gICAqIEByZXR1cm5zIHtvYmplY3R9XG4gICAqL1xuICBnZXRTdGF0ZSgpe1xuICAgIHJldHVybiB0aGlzLmV4dHJhRGF0YTtcbiAgfVxuXG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9iYWNrcGFjay5qcyJdLCJzb3VyY2VSb290IjoiIn0=